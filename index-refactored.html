<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Embryo Player v3.0 | Professional Web Sampler & Sequencer</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <!-- External CSS -->
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="title-container">
        <h1>Embryo Player v3.0</h1>
    </div>

    <div class="header-row">
        <button id="start-audio" class="header-button"><i class="fas fa-power-off"></i> Start</button>
        <button id="help-button" class="header-button help-button">?</button>
        <div id="help-modal" class="help-modal">
            <div class="help-content">
                <h3>Embryo Player v3.0 - Help</h3>

                <div class="help-section">
                    <h4>Audio Controls</h4>
                    <ul>
                        <li><strong>Start</strong> - Initialize audio context and start the player</li>
                        <li><strong>VOL</strong> - Master volume control (0-100%)</li>
                        <li><strong>DISTORTION</strong> - Audio saturation/distortion effect (0-100%)</li>
                        <li><strong>FILT</strong> - Low-pass filter cutoff (0-100%)</li>
                        <li><strong>RES</strong> - Filter resonance control (0-100%)</li>
                    </ul>
                </div>

                <div class="help-section">
                    <h4>Sequencer Controls</h4>
                    <ul>
                        <li><strong>REC</strong> - Start recording a new sequence (clears existing)</li>
                        <li><strong>DUB</strong> - Add events to existing sequence (overdub)</li>
                        <li><strong>PLAY</strong> - Play the recorded sequence</li>
                        <li><strong>STOP ALL</strong> - Stop all audio and sequences</li>
                        <li><strong>CLEAR</strong> - Clear the recorded sequence</li>
                        <li><strong>QT</strong> - Quantize control (cycles: 0%, 25%, 50%, 75%, 100%)</li>
                    </ul>
                </div>

                <div class="help-section">
                    <h4>Tempo & Timing</h4>
                    <ul>
                        <li><strong>+/-</strong> - Increase/decrease tempo</li>
                        <li><strong>BPM Display</strong> - Tap to set tempo, shows current BPM</li>
                        <li><strong>Bar/Beat</strong> - Shows current position in sequence</li>
                    </ul>
                </div>

                <div class="help-section">
                    <h4>Bank Functions</h4>
                    <ul>
                        <li><strong>A, B, C, D</strong> - Sample banks (switch between different sample sets)</li>
                        <li><strong>L/S</strong> - Load Samples (load multiple audio files)</li>
                        <li><strong>DEL</strong> - Delete Pad (delete individual pad samples)</li>
                        <li><strong>SLCR</strong> - Slicer (slice samples into parts)</li>
                    </ul>
                </div>

                <div class="help-section">
                    <h4>Input Methods</h4>
                    <ul>
                        <li><strong>Mouse/Touch</strong> - Click/tap pads to trigger samples</li>
                        <li><strong>Keyboard</strong> - Use keys 1234/QWER/ASDF/ZXCV for pads 1-16</li>
                        <li><strong>MIDI</strong> - Connect MIDI controller for external control</li>
                    </ul>
                </div>

                <div class="help-section">
                    <h4>Pad Grid</h4>
                    <ul>
                        <li><strong>16 Pads</strong> - Trigger samples, record sequences</li>
                        <li><strong>Visual Feedback</strong> - Shows active state and recording</li>
                        <li><strong>Sample Names</strong> - Display loaded sample information</li>
                    </ul>
                </div>

                <button class="close-help">×</button>
            </div>
        </div>
        <div class="empty-space"></div>
        <button id="shift-button" class="header-button" disabled style="opacity: 0.5; cursor: not-allowed;" title="SHIFT temporarily disabled - Use MIC and EDIT buttons below">SHIFT</button>
    </div>

    <!-- Input Status Indicator -->
    <div id="input-status" class="input-status">
        Active methods: [MOUSE] Mouse/Touch • [KEY] Keyboard • [MIDI] MIDI (disconnected)
    </div>

    <div class="header-row sequencer-row">
        <button id="record-sequence" class="header-button btn-record">REC</button>
        <button id="overdub-sequence" class="header-button btn-overdub">DUB</button>
        <button id="play-sequence" class="header-button btn-play">PLAY</button>
        <button id="stop-sequence" class="header-button" title="Stop all audio and sequences">STOP ALL</button>
        <button id="clear-sequence" class="header-button">CLEAR</button>
    </div>

    <!-- MIC and EDIT buttons row -->
    <div class="header-row">
        <button id="mic-button" class="header-button btn-record">MIC</button>
        <button id="edit-sample" class="header-button btn-edit">EDIT</button>
        <div class="empty-space"></div>
        <div class="empty-space"></div>
    </div>

    <div class="header-row tempo-controls">
        <button id="tempo-up" class="header-button tempo-btn bpm-button">+</button>
        <button id="tempo-display" class="header-button tempo-display tap-tempo-btn" title="Tap to set tempo">120 BPM</button>
        <button id="tempo-down" class="header-button tempo-btn bpm-button">-</button>
        <div class="header-button bar-label">bar / beat</div>
        <div id="current-bar" class="header-button bar-btn">1</div>
        <div id="current-beat" class="header-button bar-btn">1</div>
    </div>

    <div class="header-row bank-selector-row">
        <button id="bank-a" class="header-button bank-btn bank-active">A</button>
        <button id="bank-b" class="header-button bank-btn">B</button>
        <button id="bank-c" class="header-button bank-btn">C</button>
        <button id="bank-d" class="header-button bank-btn">D</button>
        <button id="bank-e" class="header-button bank-btn">QT</button>
        <button id="bank-f" class="header-button bank-btn">L/S</button>
        <button id="bank-g" class="header-button bank-btn btn-delete">DEL</button>
        <button id="bank-h" class="header-button bank-btn">SLCR</button>
    </div>

    <!-- Terminal Footer -->
    <footer id="terminal-footer" class="terminal-footer">
        <div class="terminal-content">
            <span class="terminal-prompt">></span>
            <span class="terminal-text" id="terminal-text">Waiting Input...</span>
        </div>
    </footer>

    <!-- Audio Control Sliders -->
    <div class="header-row slider-row">
        <div class="slider-container">
            <input type="range" id="slider-1" class="audio-slider" min="0" max="100" value="100">
        </div>
        <div class="slider-container">
            <input type="range" id="slider-2" class="audio-slider" min="0" max="100" value="0">
        </div>
        <div class="slider-container">
            <input type="range" id="slider-3" class="audio-slider" min="0" max="100" value="50">
        </div>
        <div class="slider-container">
            <input type="range" id="slider-4" class="audio-slider" min="0" max="100" value="25">
        </div>
    </div>

    <main>
        <div id="pad-grid" class="pad-grid">
            <!-- Pads are generated dynamically via JavaScript -->
        </div>
    </main>

    <!-- Sample Slicer Modal -->
    <div id="slicer-modal" class="slicer-modal">
        <div class="slicer-panel">
            <div class="slicer-title">Sample Slicer</div>
            <div id="slicer-info" class="slicer-info">
                Slice "sample-name" into equal parts
            </div>
            <div class="slicer-buttons" id="slicer-buttons">
                <button class="slicer-btn" onclick="embryoPlayer.applySlicer(4)">4 Slices</button>
                <button class="slicer-btn" onclick="embryoPlayer.applySlicer(8)">8 Slices</button>
                <button class="slicer-btn" onclick="embryoPlayer.applySlicer(16)">16 Slices</button>
            </div>
            <div class="slicer-actions">
                <button class="slicer-cancel" onclick="embryoPlayer.closeSlicerModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Audio Editor Modal -->
    <div id="audio-editor-modal" class="audio-editor-modal">
        <div class="audio-editor-panel">
            <div class="audio-editor-title">Audio Editor</div>
            <div class="audio-editor-info">
                <p>Pad: <span id="edit-pad-number">-</span> | Sample: <span id="edit-sample-name">-</span></p>
                <p>Selection: <span id="edit-selection-time">0.00s - 0.00s</span></p>
            </div>

            <div id="waveform-container" class="waveform-container">
                <!-- Waveform editor renders here -->
            </div>

            <div class="audio-editor-controls">
                <button id="play-selection" class="audio-editor-btn">Play Selection</button>
                <button id="play-full" class="audio-editor-btn">Play Full</button>
                <button id="reset-selection" class="audio-editor-btn">Reset</button>
            </div>

            <div class="audio-editor-actions">
                <button id="apply-trim" class="audio-editor-btn primary">Apply Trim</button>
                <button id="cancel-editing" class="audio-editor-btn">Cancel</button>
            </div>
        </div>
    </div>

    <!-- External JavaScript -->
    <script src="js/embryo-player.js"></script>
</body>
</html>
